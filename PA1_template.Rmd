---
title: "Reproducible Research: Peer Assessment 1"
author: "SlowLearner"
date: "`r Sys.Date()`"
output: 
  html_document:
    keep_md: false
    theme:
        bootswatch: morph
---
## Introduction
This assignment is intended to demonstrate a basic understanding of Reproducible Research principles using the tools R Markdown and knitr to generate a single document artifact (as html) that includes text, code and plots created during the course of the 'research'.

### Data

* Dataset: [Activity monitoring data](https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2Factivity.zip) [52K]

It includes the following variables:

* **steps**: Number of steps taking in a 5-minute interval (missing
    values are coded as `NA`)
* **date**: The date on which the measurement was taken in YYYY-MM-DD
    format
* **interval**: Identifier for the 5-minute interval in which
    measurement was taken

We need the following libraries:
```{r}
library(ggplot2)
library(dplyr)
library(stringr)
```
### Loading and preprocessing the data
No need to download the dataset. It already exists as a zip file in the working directory.
```{r}
unzip("activity.zip")
activity <- read.table("./activity.csv", sep=",", header = TRUE)
str(activity)
summary(activity)
```

## Assignment Questions

#### Q1: What is mean total number of steps taken per day?

Group and summarize the data to show daily total steps. Missing values are omitted.

```{r}
daily_steps <- summarize(group_by(na.omit(activity), date), steps = sum(steps))
```

Generate a histogram that shows the frequency (number of days) of daily steps taken. Bin width is 1000.

```{r}
ggplot(daily_steps, aes(x=steps)) +
    geom_histogram(binwidth = 1000, color = "gray", fill = "wheat") +
    labs(x = "Daily total steps",
         y = "Number of days",
         title = "Histogram of steps per day")
```

Calculate the mean and median of total daily steps.
```{r results="hide"}
mn <- as.integer(mean(daily_steps$steps))
md <- median(daily_steps$steps)
```

Mean daily steps is **`r mn`**

Median daily steps: **`r md`**

---

#### Q2: What is the average daily activity pattern?

Group the activity data by interval and calculate the average steps taken for each interval.
```{r}
interval_steps_mean <- summarize(group_by(na.omit(activity), interval), steps = mean(steps))
```

Generate a line chart that shows the average number of steps taken for each interval across the entire measurement period.


```{r}
ggplot(interval_steps_mean, aes(x=interval, y=steps)) +
    geom_line(linewidth = 0.5, color = "gray", linetype=1) +
    labs(x = "Interval (hhmm)",
         y = "Average steps taken",
         title = "Average daily activity pattern")
```

Find the interval that contains the maximum average number of steps taken.
```{r results="hide"}
ms <- interval_steps_mean %>% filter(steps==max(steps))
```


The maximum steps average is **`r ms$steps`** at **`r str_pad(ms$interval, width=4, side="left", pad="0")`**.

---

#### Q3: Imputing missing values



#### Q4: Are there differences in activity patterns between weekdays and weekends?
